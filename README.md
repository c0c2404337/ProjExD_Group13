# 工科クエスト

## 実行環境の必要条件
* python >= 3.10
* pygame >= 2.1

## ゲームの概要
* 主人公「こうかとん」となり、次々と現れる「課題」やボスの「悪の組織」を倒すRPGである。

## ゲームの遊び方
* 矢印キーでマップを移動し、キャンパス奥地のボスを目指す。
* 戦闘中はキー入力（A：攻撃、M：魔法、H：回復）でコマンドを決定し敵を倒す。
* プレイヤーのHPが0になったらGAMEOVER、ボスを倒すとゲームクリアである。

## ゲームの実装
### 共通基本機能
* マップごとの背景色切り替えと、矩形による主人公・敵キャラクターの描画

### 分担追加機能
* 戦闘担当：
マップ担当：

### 戦闘
- マップ移動中の遭遇（確率で発生）：通常敵とボスが存在します。
- 表示：敵は画面中央に描画され、画面下部に「敵HP」「プレイヤーHP」「回復残り」が表示されます。

#### 操作
- SPACE：攻撃（ダメージはランダム）
- H：回復（戦闘ごとに最大3回まで（ボス戦だと５回）使用可能。通常回復は小〜中、ボス戦では大きな回復値がランダムに入る。上限はプレイヤーの最大HPによる）
- R：GAME OVER画面でリトライ（村に戻りHP回復）
- ESC：終了

- 敵の反撃：プレイヤーが攻撃または回復を行った後に、敵が反撃してダメージを与える（雑魚は小ダメージ、ボスは強力なダメージ）
- ボス戦：キャンパス奥で発生し、敵HPが高く強力な攻撃を行います（例：敵HP 500）
- GAME OVER：プレイヤーHPが0になったらGAME OVER画面を表示します

※ 実装では `battle_message` / `battle_sub_message` を用いて攻撃や回復、反撃のメッセージを表示しています。

### 追加・改良点（本実装で追加/調整した主要機能）
- 戦闘メッセージ用の小さいフォントを追加（`self.msg_font`）し、戦闘時のメッセージ表示とHUDを小さめの文字で表示するようにしました（行間も詰めて見やすく調整）。
- メッセージログ機能：`message_log` にアクションごとのメッセージを蓄積し、最大件数（`max_messages`、既定4件）を保ちつつ画面下部に表示します。
- アイテム機能：`potion`（回復薬）、`atk`（攻撃UP）、`def`（防御UP）を実装。キー1/2/3で使用できます。
- 回復の制限と効果：通常戦は戦闘ごとに最大3回、ボス戦は最大5回の回復（キーH）。回復量は通常とボスで異なります。
- バフ（ATK/DEF）：バフの残りターン管理（`atk_buff_turns` / `def_buff_turns`）と倍率適用（`atk_multiplier` / `def_multiplier`）。
- 敵の反撃処理：攻撃・回復後に敵が反撃。ボス／雑魚でダメージ幅を変え、防御バフを適用します。
- マップ遷移とランダム遭遇：マップ端での遷移（村→フィールド→キャンパス）と、フィールド移動時に低確率でエンカウントします。
- 日本語フォント検出機能：`get_japanese_font(size)` でOS上の日本語フォントを優先して取得し、フォントが見つからない場合は代替フォントを使用します。
- 終了／リスタート処理：`GAME OVER` と `R` によるリトライ（村に戻りHP回復）、`ESC` で終了が可能です。
* 魔法や回復使用時にMP残量を確認し、不足時はターンを消費せず行動をキャンセルする機能
* レベルアップ機能：経験値取得によりレベルが上昇した際、ステータス上限の増加とHP・MPの全回復を行う機能

### メモ

